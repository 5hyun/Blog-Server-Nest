NestJS λΈ”λ΅κ·Έ μ„λ²„ API
π“ ν”„λ΅μ νΈ κ°μ”
μ΄ ν”„λ΅μ νΈλ” NestJS ν”„λ μ„μ›ν¬λ¥Ό κΈ°λ°μΌλ΅ κµ¬μ¶•λ λΈ”λ΅κ·Έμ© λ°±μ—”λ“ μ„λ²„μ…λ‹λ‹¤. TypeORMμ„ μ‚¬μ©ν•μ—¬ PostgreSQL λ°μ΄ν„°λ² μ΄μ¤μ™€ μƒνΈμ‘μ©ν•λ©°, κ²μ‹λ¬Ό(Post)μ— λ€ν• CRUD (μƒμ„±, μ΅°ν, μμ •, μ‚­μ ) APIλ¥Ό μ κ³µν•©λ‹λ‹¤.

λν•, Swagger (OpenAPI) λ¥Ό μ—°λ™ν•μ—¬ API λ…μ„Έλ¥Ό μλ™μΌλ΅ λ¬Έμ„ν™”ν•κ³ , κ°λ°μλ“¤μ΄ APIλ¥Ό μ‰½κ² ν…μ¤νΈν•κ³  μ΄ν•΄ν•  μ μλ” ν™κ²½μ„ μ κ³µν•©λ‹λ‹¤.

β¨ μ£Όμ” κΈ°μ  μ¤νƒ
Framework: NestJS

Database: PostgreSQL

ORM: TypeORM

API Documentation: Swagger (OpenAPI)

Validation: class-validator, class-transformer

Containerization: Docker

π API μ²λ¦¬ νλ¦„ (Request Flow)
ν΄λΌμ΄μ–ΈνΈμ μ”μ²­λ¶€ν„° μ‘λ‹µκΉμ§€μ μ „μ²΄μ μΈ λ°μ΄ν„° νλ¦„μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

ν΄λΌμ΄μ–ΈνΈ μ”μ²­ (Client Request)

ν΄λΌμ΄μ–ΈνΈ(μ›Ή λΈλΌμ°μ €, λ¨λ°”μΌ μ•± λ“±)κ°€ νΉμ • API μ—”λ“ν¬μΈνΈλ΅ HTTP μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤. (μ: POST /posts)

μ»¨νΈλ΅¤λ¬ (Controller) - posts.controller.ts

NestJSμ λΌμ°ν… λ©”μ»¤λ‹μ¦μ΄ μ”μ²­λ URLκ³Ό HTTP λ©”μ„λ“μ— λ§λ” ν•Έλ“¤λ¬ ν•¨μλ¥Ό νΈμ¶ν•©λ‹λ‹¤.

@Body(), @Param(), @Query() λ“±μ λ°μ½”λ μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ μ”μ²­ λ°μ΄ν„°λ¥Ό DTO(Data Transfer Object)λ΅ λ³€ν™ν•κ³  μ ν¨μ„±μ„ κ²€μ‚¬ν•©λ‹λ‹¤.

μ„λΉ„μ¤ (Service) - posts.service.ts

μ»¨νΈλ΅¤λ¬λ” λΉ„μ¦λ‹μ¤ λ΅μ§ μ²λ¦¬λ¥Ό μ„λΉ„μ¤μ— μ„μ„ν•©λ‹λ‹¤.

μ„λΉ„μ¤λ” λ°μ΄ν„°λ² μ΄μ¤μ™€ μƒνΈμ‘μ©ν•κ±°λ‚, ν•„μ”ν• λΉ„μ¦λ‹μ¤ λ΅μ§(μ: μ΅°νμ μ¦κ°€, λ°μ΄ν„° κ°€κ³µ)μ„ μν–‰ν•©λ‹λ‹¤.

νΉν, HTML μ½ν…μΈ κ°€ ν¬ν•¨λ κ²½μ° sanitize-html λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ XSS(Cross-Site Scripting) κ³µκ²©μ„ λ°©μ§€ν•κΈ° μ„ν• μ‚΄κ· (Sanitization) μ²λ¦¬λ¥Ό μν–‰ν•©λ‹λ‹¤.

λ¦¬ν¬μ§€ν† λ¦¬ (Repository) & μ—”ν‹°ν‹° (Entity) - posts.entity.ts

μ„λΉ„μ¤λ” TypeORMμ λ¦¬ν¬μ§€ν† λ¦¬ ν¨ν„΄μ„ μ‚¬μ©ν•μ—¬ λ°μ΄ν„°λ² μ΄μ¤μ™€ ν†µμ‹ ν•©λ‹λ‹¤.

Post μ—”ν‹°ν‹°λ” λ°μ΄ν„°λ² μ΄μ¤μ posts ν…μ΄λΈ”κ³Ό λ§¤ν•‘λλ” κ°μ²΄μ΄λ©°, μ„λΉ„μ¤μ™€ λ¦¬ν¬μ§€ν† λ¦¬ μ‚¬μ΄μ—μ„ λ°μ΄ν„°λ¥Ό μ£Όκ³ λ°›λ” λ° μ‚¬μ©λ©λ‹λ‹¤.

λ°μ΄ν„°λ² μ΄μ¤ (Database)

λ¦¬ν¬μ§€ν† λ¦¬λ¥Ό ν†µν•΄ μ‹¤ν–‰λ μΏΌλ¦¬κ°€ PostgreSQL λ°μ΄ν„°λ² μ΄μ¤μ—μ„ μ²λ¦¬λ©λ‹λ‹¤.

ν΄λΌμ΄μ–ΈνΈ μ‘λ‹µ (Client Response)

μ²λ¦¬ κ²°κ³Ό λ°μ΄ν„°λ” λ‹¤μ‹ μ„λΉ„μ¤λ¥Ό κ±°μ³ μ»¨νΈλ΅¤λ¬λ΅ λ°ν™λ©λ‹λ‹¤.

μ»¨νΈλ΅¤λ¬λ” μ΄ λ°μ΄ν„°λ¥Ό ν΄λΌμ΄μ–ΈνΈμ—κ² HTTP μ‘λ‹µμΌλ΅ μ „μ†΅ν•©λ‹λ‹¤. (μ£Όλ΅ JSON ν•μ‹)

π€ API μ—”λ“ν¬μΈνΈ λ…μ„Έ
basePath: /posts

κΈ°λ¥

HTTP Method

URL

μ”μ²­ Body (DTO)

μ„¤λ…

κ²μ‹λ¬Ό μƒμ„±

POST

/

CreatePostDto

μƒλ΅μ΄ κ²μ‹λ¬Όμ„ μƒμ„±ν•©λ‹λ‹¤.

μ „μ²΄ μ΅°ν

GET

/

-

λ¨λ“  κ²μ‹λ¬Ό λ©λ΅μ„ μ΅°νν•©λ‹λ‹¤.

μƒμ„Έ μ΅°ν

GET

/:id

-

νΉμ • IDμ κ²μ‹λ¬Όμ„ μƒμ„Έ μ΅°νν•κ³ , μ΅°νμλ¥Ό 1 μ¦κ°€μ‹ν‚µλ‹λ‹¤.

κ²μ‹λ¬Ό μμ •

PATCH

/:id

UpdatePostDto

νΉμ • IDμ κ²μ‹λ¬Όμ„ μμ •ν•©λ‹λ‹¤. (λ¶€λ¶„ μ—…λ°μ΄νΈ μ§€μ›)

κ²μ‹λ¬Ό μ‚­μ 

DELETE

/:id

-

νΉμ • IDμ κ²μ‹λ¬Όμ„ μ‚­μ ν•©λ‹λ‹¤.

DTO (Data Transfer Object)
CreatePostDto: κ²μ‹λ¬Ό μƒμ„±μ„ μ„ν•΄ ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° λ°›λ” λ°μ΄ν„° λ¨λΈμ…λ‹λ‹¤. title, content, authorId ν•„λ“λ¥Ό ν¬ν•¨ν•©λ‹λ‹¤.

UpdatePostDto: κ²μ‹λ¬Ό μμ •μ„ μ„ν•΄ μ‚¬μ©λλ©°, CreatePostDtoμ λ¨λ“  ν•„λ“λ¥Ό μ„ νƒμ μΌλ΅ κ°€μ§‘λ‹λ‹¤.

API λ¬Έμ„ ν™•μΈ
μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‹¤ν–‰ν• ν›„, μ•„λ μ£Όμ†μ—μ„ μƒμ„Έν• API λ…μ„Έμ™€ ν…μ¤νΈ UIλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

Swagger UI: http://localhost:3000/api-docs